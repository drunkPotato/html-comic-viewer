<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webcomic Viewer</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Webcomic Viewer</h1>

    <!-- Navigation Bar -->
    <div class="navbar">
        <button class="btn" id="prevBtn">Previous</button>

        <!-- Chapter Selection -->
        <select id="chapterSelect"></select>

        <button class="btn" id="nextBtn">Next</button>
    </div>

        <!-- Scroll Control Buttons -->
    <button id="scrollToTop" class="scroll-btn">Top</button>
    <button id="scrollToBottom" class="scroll-btn">Bottom</button>

    <!-- Comic Container -->
    <div class="comic-container" id="comicContainer"></div>

    <script>
        
        document.addEventListener("DOMContentLoaded", function () {
            
            const totalChapters = 152; // Adjust based on actual chapters            
            let currentChapter = 1; // Track the current chapter

            
            const container = document.getElementById("comicContainer");
            const chapterSelect = document.getElementById("chapterSelect");

            // Populate chapter dropdown
            document.querySelectorAll("#chapterSelect").forEach(select => {
                select.innerHTML = ""; // Clear existing options

                for (let i = 1; i <= totalChapters; i++) {
                    let option = document.createElement("option");
                    option.value = i;
                    option.textContent = `Chapter ${i}`;
                    select.appendChild(option);
                }
            });

            async function imageExists(url) {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.src = url;
                    img.onload = () => resolve(true);
                    img.onerror = () => resolve(false);
                });
            }

            async function loadChapter(chapter) {
                container.innerHTML = ""; 
                let page = 0;
                
                while (await imageExists(`Seed/seed Ch${chapter}.${page}.jpg`)) {
                    const filename = `Seed/seed Ch${chapter}.${page}.jpg}`;
                    const img = new Image();
                    img.src = filename;
                    img.loading = "lazy";
                    container.appendChild(img);
                    page++;
                }

                // Update the dropdown selection
                chapterSelect.value = chapter;
            }

            // Load the first chapter initially
            loadChapter(currentChapter);

            // Navigation Buttons
            document.querySelectorAll("#prevBtn").forEach(button => {
                button.addEventListener("click", () => {
                    if (currentChapter > 1) {
                        currentChapter--;
                        loadChapter(currentChapter);
                    }
                });
            });

            // Attach event listeners to all "Next" buttons
            document.querySelectorAll("#nextBtn").forEach(button => {
                button.addEventListener("click", () => {
                    if (currentChapter < totalChapters) {
                        currentChapter++;
                        loadChapter(currentChapter);
                    }
                });
            });
            
            // Attach event listeners to all chapter selection dropdowns
            document.querySelectorAll("#chapterSelect").forEach(select => {
                select.addEventListener("change", (event) => {
                    currentChapter = parseInt(event.target.value);
                    loadChapter(currentChapter);
                });
            });

            document.getElementById("scrollToTop").addEventListener("click", () => {
                window.scrollTo({ top: 0, behavior: "smooth" });
            });
    
                // Scroll to Bottom
            document.getElementById("scrollToBottom").addEventListener("click", () => {
                window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
            });
        });
    </script>    

<div class="navbar">
    <button class="btn" id="prevBtn">Previous</button>

    <!-- Chapter Selection -->
    <select id="chapterSelect"></select>

    <button class="btn" id="nextBtn">Next</button>
</div>
</body>
</html>
